# Allows the user to serach for an encyclopedia entry
def search(request):
    markdowner = Markdown()
    # Set variable for the search query entered by the user
    search_query = request.POST.get("q", "")

    # Obtain a list of all entries
    all_entries = util.list_entries()

    if search_query in all_entries:
        return(request, "encyclopedia/entry.html", {
            "entry_page": markdowner.convert(search_query),
            "entry_title": search_query
        })
    




# Returns a form for creating a new entry in the encyclopedia
def new(request):
    markdowner = Markdown()
    if request.method == "POST":
        form = NewEntryForm(request.POST)
        if form.is_valid():
            title = form.cleaned_data["title"]
            content = form.cleaned_data["content"]
            entries = util.list_entries()

            if title in entries:
                return render(request, "encyclopedia/error.html")
            else:
                util.save_entry(title, content)
                entry_page = util.get_entry(title)
                return render(request, "encyclopedia/new.html", {
                    "entry_page": markdowner.convert(entry_page),
                    "entry_title": title
                })


# def edit(request, title):